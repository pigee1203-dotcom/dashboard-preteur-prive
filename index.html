<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Dashboard prêteur privé</title>

<style>
:root{
  --bg:#0b1220;
  --stroke:rgba(255,255,255,.10);
  --text:rgba(255,255,255,.92);
  --muted:rgba(255,255,255,.70);
  --good:#2dd4bf;
  --warn:#fbbf24;
  --bad:#fb7185;
  --accent:#60a5fa;
  --mono: ui-monospace, Consolas, monospace;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  background:var(--bg);
  color:var(--text);
}
.wrap{max-width:1200px;margin:auto;padding:20px}
.topbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
.pill{
  display:inline-flex;align-items:center;gap:8px;
  padding:6px 10px;border-radius:999px;
  border:1px solid var(--stroke);
  background:rgba(255,255,255,.05);
  font-size:12px;color:var(--muted)
}
.dot{width:8px;height:8px;border-radius:50%}
.dot.good{background:var(--good)}
.dot.warn{background:var(--warn)}
.dot.bad{background:var(--bad)}

.panel{
  border:1px solid var(--stroke);
  border-radius:16px;
  background:rgba(255,255,255,.05);
  overflow:hidden
}
.panelHeader{
  padding:12px 14px;
  display:flex;justify-content:space-between;align-items:center;
  border-bottom:1px solid var(--stroke)
}
.btn{
  padding:8px 10px;
  border-radius:12px;
  border:1px solid var(--stroke);
  background:rgba(255,255,255,.06);
  color:var(--text);
  font-size:12px;
  cursor:pointer
}
.btn.danger{border-color:rgba(251,113,133,.6);background:rgba(251,113,133,.15)}
.btn.good{border-color:rgba(45,212,191,.6);background:rgba(45,212,191,.15)}

table{width:100%;border-collapse:collapse;font-size:12.5px}
th,td{padding:10px;border-bottom:1px solid var(--stroke);white-space:nowrap}
th{color:var(--muted);text-align:left}
tr:hover td{background:rgba(255,255,255,.04)}
.mono{font-family:var(--mono)}
.status{
  display:inline-flex;align-items:center;gap:6px;
  padding:4px 8px;border-radius:999px;
  border:1px solid var(--stroke);
  font-size:11px;color:var(--muted)
}
</style>
</head>

<body>
<div class="wrap">

  <div class="topbar">
    <h2>Calendrier des paiements</h2>
    <div class="pill"><span class="dot good"></span> Mode local</div>
  </div>

  <div class="panel">
    <div class="panelHeader">
      <div class="pill"><span class="dot warn"></span> Sélection #<span id="sel">1</span></div>
      <div>
        <button class="btn danger" onclick="doNSF()">❌ NSF</button>
        <button class="btn good" onclick="doPay()">✅ PAYÉ</button>
      </div>
    </div>

    <table>
      <thead>
        <tr>
          <th>#</th>
          <th>Date</th>
          <th>Total</th>
          <th>Intérêt</th>
          <th>Capital</th>
          <th>Adhésion</th>
          <th>Statut</th>
          <th>Solde après</th>
        </tr>
      </thead>
      <tbody id="rows"></tbody>
    </table>
  </div>

</div>

<script>
const money = n => Number(n).toLocaleString('fr-CA',{minimumFractionDigits:2})+' $';
const rate = 0.1899;

let selected = 1;
let balance = 2250;

let rows = [
 {i:1,date:'2024-11-15',total:147.92,adh:45,status:'À venir'},
 {i:2,date:'2024-11-29',total:147.19,adh:45,status:'À venir'},
 {i:3,date:'2024-12-13',total:146.56,adh:45,status:'À venir'},
];

function render(){
  const tb = document.getElementById('rows');
  tb.innerHTML = '';
  let bal = balance;

  rows.forEach(r=>{
    let interest = r.status==='PAYÉ' ? +(bal*rate/26).toFixed(2) : 0;
    let capital = r.status==='PAYÉ' ? +(r.total-r.adh-interest).toFixed(2) : 0;
    let after = r.status==='PAYÉ' ? +(bal-capital).toFixed(2) : bal;

    const dot =
      r.status==='NSF' ? 'bad' :
      r.status==='PAYÉ' ? 'good' : 'warn';

    tb.innerHTML += `
      <tr onclick="select(${r.i})" style="${r.i===selected?'background:rgba(96,165,250,.08)':''}">
        <td class="mono">${r.i}</td>
        <td>${r.date}</td>
        <td class="mono">${money(r.total)}</td>
        <td class="mono">${money(interest)}</td>
        <td class="mono">${money(capital)}</td>
        <td class="mono">${money(r.adh)}</td>
        <td><span class="status"><span class="dot ${dot}"></span>${r.status}</span></td>
        <td class="mono">${money(after)}</td>
      </tr>`;
    bal = after;
  });
}

function select(i){
  selected=i;
  document.getElementById('sel').textContent=i;
  render();
}

function doNSF(){
  const r = rows.find(x=>x.i===selected);
  r.status='NSF';
  render();
}

function doPay(){
  const r = rows.find(x=>x.i===selected);
  r.status='PAYÉ';
  render();
}

render();
</script>
</body>
</html>
